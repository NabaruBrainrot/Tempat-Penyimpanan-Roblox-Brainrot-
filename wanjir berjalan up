-- Hapus GUI lama jika ada
pcall(function() game.CoreGui:FindFirstChild("PremiumDeliveryGUI"):Destroy() end)

-- Service & Player
local CoreGui = game:GetService("CoreGui")
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")

local player = Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local humanoidRootPart = character:WaitForChild("HumanoidRootPart")
local humanoid = character:WaitForChild("Humanoid")

-- GUI Setup
local gui = Instance.new("ScreenGui", CoreGui)
gui.Name = "PremiumDeliveryGUI"
gui.ResetOnSpawn = false

local frame = Instance.new("Frame")
frame.Name = "MainFrame"
frame.Size = UDim2.new(0, 170, 0, 85) -- diperbesar 5% dari versi kecil (160x80)
frame.Position = UDim2.new(0.1, 0, 0.4, 0)
frame.BackgroundColor3 = Color3.fromRGB(20, 20, 30)
frame.BorderSizePixel = 0
frame.Active = true
frame.Draggable = false
frame.Parent = gui

Instance.new("UICorner", frame).CornerRadius = UDim.new(0, 11)

local stroke = Instance.new("UIStroke", frame)
stroke.Thickness = 2
stroke.Color = Color3.fromRGB(0, 200, 255)

-- Judul
local title = Instance.new("TextLabel", frame)
title.Size = UDim2.new(1, -26, 0, 22)
title.Position = UDim2.new(0, 9, 0, 4)
title.BackgroundTransparency = 1
title.Text = "⚡ Speed Booster"
title.TextColor3 = Color3.fromRGB(0, 200, 255)
title.Font = Enum.Font.GothamBold
title.TextSize = 14 -- naik sedikit
title.TextXAlignment = Enum.TextXAlignment.Left

-- Tombol Close
local closeBtn = Instance.new("TextButton", frame)
closeBtn.Size = UDim2.new(0, 22, 0, 22)
closeBtn.Position = UDim2.new(1, -26, 0, 4)
closeBtn.BackgroundColor3 = Color3.fromRGB(200, 0, 0)
closeBtn.Text = "X"
closeBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
closeBtn.Font = Enum.Font.GothamBold
closeBtn.TextSize = 13
Instance.new("UICorner", closeBtn).CornerRadius = UDim.new(0, 5)

closeBtn.MouseButton1Click:Connect(function()
	gui:Destroy()
end)

-- Tombol Toggle
local toggleBtn = Instance.new("TextButton", frame)
toggleBtn.Size = UDim2.new(0.9, 0, 0, 34)
toggleBtn.Position = UDim2.new(0.05, 0, 0, 38)
toggleBtn.BackgroundColor3 = Color3.fromRGB(45, 45, 65)
toggleBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
toggleBtn.Font = Enum.Font.GothamSemibold
toggleBtn.TextSize = 13
toggleBtn.Text = "▶ Start"
Instance.new("UICorner", toggleBtn).CornerRadius = UDim.new(0, 7)

-- Logic Speed
local speed = 40
local active = false
local mover
local heartbeatConn

local function startSpeed()
	if mover then mover:Destroy() end
	mover = Instance.new("BodyVelocity")
	mover.Velocity = Vector3.new(0, 0, 0)
	mover.MaxForce = Vector3.new(9e9, 0, 9e9)
	mover.Parent = humanoidRootPart

	if heartbeatConn then heartbeatConn:Disconnect() end
	heartbeatConn = RunService.Heartbeat:Connect(function()
		if active and mover then
			local moveDir = humanoid.MoveDirection
			mover.Velocity = moveDir * speed
		end
	end)
end

local function stopSpeed()
	if mover then mover:Destroy() mover = nil end
	if heartbeatConn then heartbeatConn:Disconnect() heartbeatConn = nil end
end

toggleBtn.MouseButton1Click:Connect(function()
	if active then
		active = false
		toggleBtn.Text = "▶ Start"
		toggleBtn.BackgroundColor3 = Color3.fromRGB(45, 45, 65)
		stopSpeed()
	else
		active = true
		toggleBtn.Text = "■ Stop"
		toggleBtn.BackgroundColor3 = Color3.fromRGB(0, 200, 120)
		startSpeed()
	end
end)

-- Respawn Handler
Players.LocalPlayer.CharacterAdded:Connect(function(newChar)
	character = newChar
	humanoidRootPart = character:WaitForChild("HumanoidRootPart")
	humanoid = character:WaitForChild("Humanoid")
	if active then
		task.wait(1)
		startSpeed()
	end
end)

-- Drag Function
local dragging, dragInput, dragStart, startPos
local function update(input)
	local delta = input.Position - dragStart
	frame.Position = UDim2.new(
		startPos.X.Scale, startPos.X.Offset + delta.X,
		startPos.Y.Scale, startPos.Y.Offset + delta.Y
	)
end

frame.InputBegan:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
		dragging = true
		dragStart = input.Position
		startPos = frame.Position

		input.Changed:Connect(function()
			if input.UserInputState == Enum.UserInputState.End then
				dragging = false
			end
		end)
	end
end)

frame.InputChanged:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
		dragInput = input
	end
end)

UserInputService.InputChanged:Connect(function(input)
	if input == dragInput and dragging then
		update(input)
	end
end)